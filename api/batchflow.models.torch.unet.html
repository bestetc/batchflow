

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>UNet &mdash; BatchFlow 0.3.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Research" href="../intro/research.html" />
    <link rel="prev" title="SqueezeNet" href="batchflow.models.torch.squeezenet.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> BatchFlow
          

          
          </a>

          
            
            
              <div class="version">
                0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/intro.html">A short introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../intro/classes.html">Classes and capabilities</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../intro/dsindex.html">Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/dataset.html">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/batch.html">Batch class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/images_batch.html">Batch class for handling images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/named_expr.html">Named expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/parallel.html">Within batch parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/prefetch.html">Inter-batch parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/models.html">Working with models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tf_models.html">Tensorflow models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/tf_layers.html">Tensorflow layers and losses</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../intro/torch_models.html">Torch models</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="batchflow.models.torch.models.html">Models</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.torch.base.html">TorchModel</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.torch.vgg.html">VGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.torch.resnet.html">ResNet</a></li>
<li class="toctree-l4"><a class="reference internal" href="batchflow.models.torch.squeezenet.html">SqueezeNet</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">UNet</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/research.html">Research</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/model_zoo.html">Model zoo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="batchflow.html">API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BatchFlow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../intro/classes.html">Classes and capabilities</a> &raquo;</li>
        
          <li><a href="../intro/torch_models.html">Torch models</a> &raquo;</li>
        
          <li><a href="batchflow.models.torch.models.html">Models</a> &raquo;</li>
        
      <li>UNet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/batchflow.models.torch.unet.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-batchflow.models.torch.unet">
<span id="unet"></span><h1>UNet<a class="headerlink" href="#module-batchflow.models.torch.unet" title="Permalink to this headline">¶</a></h1>
<p>Ronneberger O. et al “<a class="reference external" href="https://arxiv.org/abs/1505.04597">U-Net: Convolutional Networks for Biomedical Image Segmentation</a>”</p>
<dl class="py class">
<dt id="batchflow.models.torch.unet.UNet">
<em class="property">class </em><code class="sig-name descname">UNet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#UNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.UNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">batchflow.models.torch.encoder_decoder.EncoderDecoder</span></code></p>
<p>UNet-like model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>auto_build</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em>, </em><em>optional</em>) – <p>Parameters for auto-building <cite>filters</cite> in accordance with the idea described in the original paper.
Note that any of <cite>filters</cite>, if passed, will be replaced by auto-built ones.</p>
<dl class="simple">
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of encoder/decoder stages — defines network depth and the number of its skip connections</p>
</dd>
<dt>filters<span class="classifier">int, optional</span></dt><dd><p>number of filters in first encoder block — each of the following ones will be doubled until embedding</p>
</dd>
</dl>
</p></li>
<li><p><strong>body</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – <dl>
<dt>encoder<span class="classifier">dict</span></dt><dd><dl>
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of downsampling blocks (default=4)</p>
</dd>
<dt>blocks<span class="classifier">dict</span></dt><dd><p>Parameters for pre-processing blocks:</p>
<dl class="simple">
<dt>filters<span class="classifier">None, int, list of ints or list of lists of ints</span></dt><dd><p>The number of filters in the output tensor.
If int, same number of filters applies to all layers on all stages
If list of ints, specifies number of filters in each layer of different stages
If list of list of ints, specifies number of filters in different layers on different stages
If not given or None, filters parameters in encoder/blocks, decoder/blocks and decoder/upsample
default to values which make number of filters double
on each stage of encoding and halve on each stage of decoding,
provided that <cite>decoder/skip</cite> is <cite>True</cite>. Specify <cite>filters=None</cite> explicitly
if you want to use custom <cite>num_steps</cite> and infer <cite>filters</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>decoder<span class="classifier">dict</span></dt><dd><dl>
<dt>num_stages<span class="classifier">int</span></dt><dd><p>number of upsampling blocks. Defaults to the number of downsamplings.</p>
</dd>
<dt>factor<span class="classifier">None, int or list of ints</span></dt><dd><p>If int, the total upsampling factor for all stages combined.
If list, upsampling factors for each stage
If not given or None, defaults to [2]*num_stages</p>
</dd>
<dt>blocks<span class="classifier">dict</span></dt><dd><p>Parameters for post-processing blocks:</p>
<dl class="simple">
<dt>filters<span class="classifier">None, int, list of ints or list of lists of ints</span></dt><dd><p>same as encoder/blocks/filters</p>
</dd>
</dl>
</dd>
<dt>upsample<span class="classifier">dict</span></dt><dd><p>Parameters for upsampling (see <a class="reference internal" href="batchflow.models.tf.layers.html#batchflow.models.tf.layers.upsample" title="batchflow.models.tf.layers.upsample"><code class="xref py py-func docutils literal notranslate"><span class="pre">upsample()</span></code></a>).</p>
<dl class="simple">
<dt>filters<span class="classifier">int, list of ints or list of lists of ints</span></dt><dd><p>same as encoder/blocks/filters</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For more parameters see <a class="reference internal" href="batchflow.models.tf.encoder_decoder.html#batchflow.models.tf.encoder_decoder.EncoderDecoder" title="batchflow.models.tf.encoder_decoder.EncoderDecoder"><code class="xref py py-class docutils literal notranslate"><span class="pre">EncoderDecoder</span></code></a>.</p>
<dl class="py method">
<dt id="batchflow.models.torch.unet.UNet.default_config">
<em class="property">classmethod </em><code class="sig-name descname">default_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#UNet.default_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.UNet.default_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model’s defaults.</p>
</dd></dl>

<dl class="py method">
<dt id="batchflow.models.torch.unet.UNet.build_config">
<code class="sig-name descname">build_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#UNet.build_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.UNet.build_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model’s architecture configuration.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="batchflow.models.torch.unet.ResUNet">
<em class="property">class </em><code class="sig-name descname">ResUNet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#ResUNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.ResUNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#batchflow.models.torch.unet.UNet" title="batchflow.models.torch.unet.UNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">batchflow.models.torch.unet.UNet</span></code></a></p>
<p>UNet with residual blocks.</p>
<dl class="py method">
<dt id="batchflow.models.torch.unet.ResUNet.default_config">
<em class="property">classmethod </em><code class="sig-name descname">default_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#ResUNet.default_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.ResUNet.default_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model’s defaults.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="batchflow.models.torch.unet.DenseUNet">
<em class="property">class </em><code class="sig-name descname">DenseUNet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#DenseUNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.DenseUNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#batchflow.models.torch.unet.UNet" title="batchflow.models.torch.unet.UNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">batchflow.models.torch.unet.UNet</span></code></a></p>
<p>UNet with dense blocks.</p>
<dl class="py method">
<dt id="batchflow.models.torch.unet.DenseUNet.default_config">
<em class="property">classmethod </em><code class="sig-name descname">default_config</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/models/torch/unet.html#DenseUNet.default_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.models.torch.unet.DenseUNet.default_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Define model’s defaults.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../intro/research.html" class="btn btn-neutral float-right" title="Research" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="batchflow.models.torch.squeezenet.html" class="btn btn-neutral float-left" title="SqueezeNet" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2021, Analysis Center.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>